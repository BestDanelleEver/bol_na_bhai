<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>bolnabhai</title>
    {{> head}}
</head>
<body>
    {{> profileHead}}
    <div class="jumbotron" style="padding-top: 100px;">
        <div class="container">

           <div class="row">
               <div class="col-6-md" style="margin-right:20px; ">
                   <img class="img-fluid img-thumbnail" src="{{path}}" style="height: 300px">
               </div>
               <div class="col-6-md">
                   hello,<h1 style="font-weight: bolder">{{name}}</h1> <h4>({{username}})</h4>
                   <span>Messages: </span><span style="font-weight: bolder; font-size: 30px;" id="totalMessages">{{totalMessages}}</span>
                    <br><br>
                   <div style="font-size:12px;">Share your feedback Link:</div>
                        <a style="color:red" target="_blank" href="http://bolnabhai.herokuapp.com/feedback{{username}}"><input style="width: 400px;" type="text" value="http://bolnabhai.herokuapp.com/feedback{{username}}" id="link"></a>

                   <button id="copy" style="padding: 4px 4px;" class="btn btn-outline-danger "><i class="fa fa-clipboard" aria-hidden="true"></i> Copy</button>




               </div>
           </div>
        </div>
    </div>
    <div class="container">
        <br><h1>Your Messages:</h1>
        {{#each confessionsdata}}
        <div class="alert alert-dark" id="feedback{{dataValues.id}}">
        <div class="row">
            <div class="col-11">
        <p style="margin-bottom: 0px" ">{{dataValues.confession}}</p>
            </div>
                <div class="col-1">
            <span class="btn btn-sm btn-outline-danger" style="padding: 0px 2px;" onclick="deleteMessage(event)"><i  feedbackId="{{dataValues.id}}"  class="fa fa-times" aria-hidden="true"></i></span>
        </div>
        </div>
        {{#if dataValues.flag}}
            <p style="text-align:right;font-weight: bolder;margin-bottom: 0px">- Anonymous</p>
        {{else}}
            <p style="text-align:right;font-weight: bolder;margin-bottom: 0px">- {{dataValues.confesserUsername}}</p>
        {{/if}}
        </div>
    {{/each}}

    </div>


    <script>

        var copyTextareaBtn = document.querySelector('#copy');

        copyTextareaBtn.addEventListener('click', function(event) {
            var copyTextarea = document.getElementById('link');
            copyTextarea.select();
            document.execCommand('copy');

        });
        function deleteMessage(event){
            event.target.parentNode.parentNode.parentNode.parentNode.remove();
            document.getElementById('totalMessages').innerText = (parseInt(document.getElementById('totalMessages').innerText)-1);

            $.post('/deleteMessage',{feedbackId:event.target.getAttribute('feedbackId')});
          }


    </script>

</body>
</html>